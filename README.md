libnfldap
=========

A Python module to generate IPTables and IPSet rules from LDAP records.
See example.py for a demo.

Example
=======

```bash
$ python example.py
====== IPTABLES RULES ======
# Generated by libnfldap on 2014-06-02 12:25:26.966582
*raw
:PREROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A OUTPUT -o lo -j NOTRACK
-A PREROUTING -i lo -j NOTRACK

*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]


*nat
:PREROUTING ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]


*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:someuser - [0:0]
-A INPUT -i lo -j ACCEPT
-A OUTPUT -o lo -j ACCEPT
-A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
-A OUTPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
-A OUTPUT -p tcp --dport 80 -j ACCEPT
-A someuser -p tcp --dport 443 -d 10.0.0.2 -j ACCEPT
-A INPUT -j DROP
-A OUTPUT -j DROP
-A FILTER -j DROP

COMMIT


====== IPSET RULES ======
# Generated by libnfldap on 2014-06-02 12:25:26.966747
create customset hash:net family inet hashsize 1024 maxelem 65536
add customset 10.0.2.0/16
COMMIT
```

Authors
=======
Julien Vehent & Guillaume Destuynder (@ mozilla)
